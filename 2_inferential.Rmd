---
output: html_document
editor_options: 
  chunk_output_type: console
---

## The effect of confidence on RT
Confidence has a significant impact on RT.
```{r warning=FALSE}
model <- glmmTMB(DT_confidence ~ DT_RT + (1|ID) + (1|item), data = df) # removed trial
parameters(model, effects = "fixed")
viz_data <- estimate_relation(model)
ggplot(data = viz_data, aes(x = DT_RT, y = Predicted)) +
  geom_point(data = df, aes(x = DT_RT, y = DT_confidence, color = ID), show.legend = FALSE) +
  geom_line() +
  geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.3)

# what's the include_random thing (6.5 vs 6.7)
```

## Interaction of condition and instruction
### Confidence
There is a significant interaction of condition and instruction on confidence.
The increase in confidence from lie to truth is more in polygraph than social.
```{r}
model <- glmmTMB(DT_confidence ~ condition*instruction + (1|ID) + (1|item), data = df)
parameters(model, effects = "fixed")
means <- modelbased::estimate_means(model, at = c("condition", "instruction"))
contrasts <- modelbased::estimate_contrasts(model, contrast = c("condition", "instruction"))
ggplot(means, aes(x = instruction, y = Mean, colour = condition)) + 
  geom_line(aes(group = condition)) +
  geom_pointrange(aes(ymin = CI_low, ymax= CI_high))
```

### Reaction time
There is no significant interaction of condition and instruction on RT.
```{r}
model <- glmmTMB(DT_RT ~ condition*instruction + (1|ID) + (1|item), data = df)
parameters(model, effects = "fixed")
means <- modelbased::estimate_means(model, at = c("condition", "instruction"))
ggplot(means, aes(x = instruction, y = Mean, colour = condition)) + 
  geom_line(aes(group = condition)) +
  geom_pointrange(aes(ymin = CI_low, ymax= CI_high))
```

## Interaction of style and instruction
### Confidence
There is no significant interaction of style and instruction on confidence.
```{r}
model <- glmmTMB(DT_confidence ~ style*instruction + (1|ID) + (1|item), data = df)
parameters(model, effects = "fixed")
means <- modelbased::estimate_means(model, at = c("style", "instruction"))
ggplot(means, aes(x = instruction, y = Mean, colour = style)) + 
  geom_line(aes(group = style)) +
  geom_pointrange(aes(ymin = CI_low, ymax= CI_high))
```

### Reaction time
There is no significant interaction of style and instruction on RT.
```{r}
model <- glmmTMB(DT_RT ~ style*instruction + (1|ID) + (1|item), data = df)
parameters(model, effects = "fixed")
means <- modelbased::estimate_means(model, at = c("style", "instruction"))
ggplot(means, aes(x = instruction, y = Mean, colour = style)) + 
  geom_line(aes(group = style)) +
  geom_pointrange(aes(ymin = CI_low, ymax= CI_high))
```