---
output: html_document
editor_options: 
  chunk_output_type: console
---

## Inter-Measures Correlation {.tabset}

```{r message=FALSE, warning=FALSE}
dfsub <- df |> 
  select(Participant, 
         starts_with("YONI_"), 
         starts_with("BES_"),
         starts_with("HCT_"),
         starts_with("HTT_"),
         starts_with("MAIA_"),
         starts_with("LIE_")) |> 
  group_by(Participant) |> 
  summarise_all(mean)
```

### Theory of Mind / Empathy

```{r message=FALSE, warning=FALSE}
r <- correlation(select(dfsub, starts_with("YONI_")),
                 select(dfsub, starts_with("BES_")), 
                 p_adjust = "none")

summary(r) |> 
  plot() 
```

### Interoception

```{r message=FALSE, warning=FALSE}
r <- correlation(select(dfsub, starts_with("HTT_")),
                 select(dfsub, starts_with("HCT_")), 
                 p_adjust = "none")

summary(r) |> 
  plot()
```

```{r message=FALSE, warning=FALSE}
r <- correlation(select(dfsub, starts_with("MAIA_")),
                 select(dfsub, starts_with("HCT_"), starts_with("HTT_")), 
                 p_adjust = "none")

summary(r) |> 
  plot()
```

### ToM and Interoception

```{r message=FALSE, warning=FALSE}
r <- correlation(select(dfsub, starts_with(c("MAIA_", "HCT_"))),
                 select(dfsub, starts_with(c("YONI_", "BES_"))), 
                 p_adjust = "none")

summary(r) |> 
  plot()
```

### Deception Task and LIE Scale

```{r message=FALSE, warning=FALSE}
r <- df |> 
  select(Participant, Answer, Confidence, RT, HeartRate) |> 
  group_by(Participant, Answer) |> 
  summarise_all(mean, na.rm=TRUE) |> 
  tidyr::pivot_wider(names_from = "Answer", values_from = c("Confidence", "RT", "HeartRate")) |> 
  ungroup() |> 
  select(-Participant) |> 
  correlation(select(dfsub, starts_with("LIE_")), p_adjust = "none")

summary(r) |> 
  plot()
```


### Confidence and RT

- When lying, the faster they answer, the more confident they are.

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(Confidence ~ RT * Answer + (1|Participant) + (1|Item), 
                 data = df, family = beta_family())

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
modelbased::estimate_slopes(model, trend = "RT", at = "Answer")
```

```{r message=FALSE, warning=FALSE}
estimate_relation(model, at = c("RT", "Answer")) |> 
  plot(length = 50, point = list(alpha = 0.3, size = 3.5)) 
```

### Confidence and Heart Rate

- More confidence in truths is associated with higher heart rate.

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(Confidence ~ HeartRate * Answer + (1|Participant) + (1|Item), 
                 data = df, family = beta_family()) # warning can be ignored

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
modelbased::estimate_slopes(model, trend = "HeartRate", at = "Answer")
```

```{r message=FALSE, warning=FALSE}
estimate_relation(model, at = c("HeartRate", "Answer")) |> 
  plot(length = 50, point = list(alpha = 0.3, size = 3.5)) 
```


### RT and Heart Rate

- No relationship.

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(RT ~ HeartRate * Answer + (1|Participant) + (1|Item), 
                 data = df)

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
estimate_relation(model, at = c("HeartRate", "Answer")) |> 
  plot(length = 50, point = list(alpha = 0.3, size = 3.5)) 
```

## Effect of Phrasing {.tabset}

- Main effect of phrasing on RT only. Indirect questions lead to slower answers.


### RT

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(RT ~ Answer * Phrasing + (1|Participant), data = df) 

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Answer", "Phrasing")) |> 
  plot(show_data = "none") 
```

### Confidence

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(Confidence ~ Answer * Phrasing + (1|Participant), data = df) 

parameters::parameters(model)
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Answer", "Phrasing")) |> 
  plot(show_data = "none") 
```

### Heart Rate

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(HeartRate ~ Answer * Phrasing + (1|Participant), data = df) 

parameters::parameters(model)
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Answer", "Phrasing")) |> 
  plot(show_data = "none") 
```




## Effect of Condition

### Confidence

- Significant interaction between the condition and the answer: the effect of answer (being more confident in truths than in lies) is lower in the social condition.
- Effect mostly driven by lower lie confidence in the polygraph condition: less obvious feedback cues?

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(Confidence ~ Answer * Condition + (1|Participant) + (1|Item), 
                 data = df, family = beta_family())

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
modelbased::estimate_contrasts(model, contrast = "Answer", at = "Condition")
modelbased::estimate_contrasts(model, contrast = "Condition", at = "Answer")
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Condition", "Answer")) |> 
  plot(show_data = "none") 
```



### RT

- Significant main effect of the condition: people are slower in the polygraph condition.
- Consistent with the "less intuitive cues".

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(RT ~ Answer * Condition + (1|Participant) + (1|Item), 
                 data = df)

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Condition", "Answer")) |> 
  plot(show_data = "none") 
```


### Heart Rate

- Higher heart rate in lies vs. truths, and higher heart rate in social condition vs. polygraph.
- No interaction.

```{r message=FALSE, warning=FALSE}
model <- glmmTMB(HeartRate ~ Answer * Condition + (1|Participant) + (1|Item), 
                 data = df)

parameters::parameters(model, effects = "fixed")
```

```{r message=FALSE, warning=FALSE}
modelbased::estimate_contrasts(model, contrast = "Answer", at = "Condition")
modelbased::estimate_contrasts(model, contrast = "Condition", at = "Answer")
```

```{r message=FALSE, warning=FALSE}
estimate_means(model, at = c("Condition", "Answer")) |> 
  plot(show_data = "none") 
```

