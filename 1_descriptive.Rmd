---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r message=FALSE}
df.plot <- df %>% 
  group_by(ID, condition, instruction) %>% 
  summarise(DT_confidence = mean(DT_confidence, na.rm = TRUE),
            DT_RT = mean(DT_RT, na.rm = TRUE),
            yoni_total = mean(yoni_total, na.rm = TRUE),
            BES_total = mean(BES_total, na.rm = TRUE),
            HCT_confidence = mean(HCT_confidence, na.rm = TRUE),
            HCT_accuracy = mean(HCT_accuracy, na.rm = TRUE),
            HCT_awareness = mean(HCT_awareness, na.rm = TRUE),
            MAIA_total = mean(MAIA_total, na.rm = TRUE),
            lie_ability = mean(lie_ability, na.rm = TRUE),
            lie_frequency = mean(lie_frequency, na.rm = TRUE),
            lie_negativity = mean(lie_negativity, na.rm = TRUE),
            lie_contextuality = mean(lie_contextuality, na.rm = TRUE))
```

## Questionnaires
```{r message=FALSE}
p <- ggplot(df.plot, aes(yoni_total)) + geom_histogram()
q <- ggplot(df.plot, aes(BES_total)) + geom_histogram()
r <- ggplot(df.plot, aes(yoni_total, BES_total)) + geom_point()
s <- ggplot(df.plot, aes(HCT_accuracy)) + geom_histogram()
t <- ggplot(df.plot, aes(MAIA_total)) + geom_histogram()
u <- ggplot(df.plot, aes(HCT_accuracy, MAIA_total)) + geom_point()
(p + q + r)/(s + t + u) 
```

## Deception Task
much higher confidence in truth
no diff in reaction time in truth or lie
not much diff for diff conditions
```{r warning=FALSE}
p <- ggplot(df, aes(DT_confidence)) + geom_density()
q <- ggplot(df, aes(DT_RT)) + geom_density()

r <- ggplot(df, aes(instruction, DT_confidence, fill = condition)) + geom_boxplot()
s <- ggplot(df, aes(instruction, DT_RT, fill = condition)) + geom_boxplot()

(p + q)/(r + s)
```

## Questionnaire and Deception Task
interesting that the social tests are more correlated with polygraph and vice versa

### Yoni and BES
both yoni and BES do not seem to have effect in social condition, higher yoni/BES increases confidence in truth and decreases confidences in lie
```{r message=FALSE, warning=FALSE}
p <- ggplot(df.plot, aes(x = yoni_total, y = DT_confidence, colour = instruction)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  facet_wrap(~condition)

q <- ggplot(df.plot, aes(x = BES_total, y = DT_confidence, colour = instruction)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  facet_wrap(~condition)

p + q
```

### HCT
same effect in both social and polygraph, higher HCT accuracy decreases confidence in truth and increases confidence in lie
```{r message=FALSE, warning=FALSE}
ggplot(df.plot, aes(x = HCT_accuracy, y = DT_confidence, colour = instruction)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  facet_wrap(~condition)
```

### MAIA
same effect for lie in both social and polygraph, higher MAIA increases confidence
higher MAIA increases confidence in lie for social and not polygraph
```{r message=FALSE, warning=FALSE}
ggplot(df.plot, aes(x = MAIA_total, y = DT_confidence, colour = instruction)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  facet_wrap(~condition)
```
